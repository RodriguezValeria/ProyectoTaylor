{"cells":[{"cell_type":"code","execution_count":3,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:36.626320Z","iopub.status.busy":"2020-10-14T01:46:36.625073Z","iopub.status.idle":"2020-10-14T01:46:42.677013Z","shell.execute_reply":"2020-10-14T01:46:42.676435Z"},"id":"yG_n40gFzf9s","executionInfo":{"status":"ok","timestamp":1732289386188,"user_tz":360,"elapsed":620,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["import tensorflow as tf\n","import pandas as pd\n","import numpy as np\n","import os\n","import time"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"PfsBDZfWI86Q","executionInfo":{"status":"ok","timestamp":1732288686057,"user_tz":360,"elapsed":1068,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["data=pd.read_csv('final_taylor_swift_lyrics.tsv',sep='\\t')"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"SBOm_4F-I86R","executionInfo":{"status":"ok","timestamp":1732288688704,"user_tz":360,"elapsed":583,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["START_P=data[data.line_number==0].index.tolist()"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"PoGoAv7JI86S","executionInfo":{"status":"ok","timestamp":1732288691641,"user_tz":360,"elapsed":1326,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["\n","TERM=[]\n","for i in range(len(START_P)-1):\n","    LYR=np.array(data[START_P[i]:START_P[i+1]].lyric)\n","    term=LYR[0]+'\\n '\n","    for t in LYR[1::]:\n","        term=term+t+ ' \\n '\n","    TERM.append(term)"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"o5d8P9eAI86T","executionInfo":{"status":"ok","timestamp":1732288694439,"user_tz":360,"elapsed":385,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["new_term=TERM[0]+' \\n'\n","for t in TERM:\n","    new_term=new_term+t+' \\n'"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"FZoO0ivnI86T","executionInfo":{"status":"ok","timestamp":1732288697080,"user_tz":360,"elapsed":464,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["f = open(\"fuke.txt\", \"a\")\n","f.write(\"Now the file has more content!\")\n","f.close()"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"hq8EdGAAI86U","executionInfo":{"status":"ok","timestamp":1732288698926,"user_tz":360,"elapsed":3,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["text = open('choruses.txt', 'rb').read().decode(encoding='utf-8')"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"on5iVFIZI86U","outputId":"3a991f2b-0b38-4cfc-8a94-8ef7ba4e8f75","colab":{"base_uri":"https://localhost:8080/","height":191},"executionInfo":{"status":"ok","timestamp":1732288701503,"user_tz":360,"elapsed":5,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["\"Can I go where you go? \\n Can we always be this close? \\n Forever and ever, ah \\n Take me out, and take me home \\n You're my, my, my, my lover \\n Ooh, look what you made me do \\n Look what you made me do \\n Look what you just made me do \\n Look what you just made me— \\n Ooh, look what you made me do \\n Look what you made me do \\n Look what you just made me do \\n Look what you just made me do \\n So oh-oh, oh-oh, oh-oh, oh-oh, oh-oh \\n You need to calm down, you're being too loud \\n And I'm just like oh-oh, oh-oh, oh-oh, oh-oh, oh-oh (Oh) \\n You need to just stop, like can you just not step on my gown? \\n You need to calm down \\n In the middle of the night, in my dreams \\n You should see the things we do, baby \\n In the middle of the night, in my dreams \\n I know I'm gonna be with you, so I take my time \\n Are you ready for it? \\n So it's gonna be forever \\n Or it's gonna go down in flames \\n You can tell me when it's over, mm \\n If the high was worth the pain \\n Got a long list of ex-lovers \\n They'll tell you I'm insane \\n 'Cause you know I love the players \\n And you love the game \\n 'Cause we're young and we're reckless \\n We'll take this way too far \\n It'll leave you breathless, hmm \\n Or with a nasty scar \\n Got a long list of ex-lovers \\n They'll tell you I'm insane \\n But I've got a blank space, baby \\n And I'll write your name \\n But I knew you \\n Dancin' in your Levi's \\n Drunk under a streetlight, I \\n I knew you \\n Hand under my sweatshirt \\n Baby, kiss it better, I \\n But we were something, don't you think so? \\n Roaring twenties, tossing pennies in the pool \\n And if my wishes came true \\n It would've been you \\n In my defense, I have none \\n For never leaving well enough alone \\n But it would've been fun \\n If you would've been the one \\n (Ooh) \\n My baby's fit like a daydream \\n Walking with his head down \\n I'm the one he's walking to \\n So call it what you want, yeah \\n Call it what you want to \\n My baby's fly like a jet stream \\n High above the whole scene \\n Loves me like I'm brand new \\n So call it what you want, yeah \\n Call it what you want to \\n Is it cool that I said all that? \\n Is it chill that you're in my head? \\n 'Cause I know that it's delicate (Delicate) \\n Is it cool that I said all that? \\n Is it too soon to do this yet? \\n 'Cause I know that it's delicate \\n Isn't it? Isn't it? Isn't it? \\n Isn't it? \\n Isn't it? Isn't it? Isn't it? \\n Isn't it... delicate? \\n And it's new, the shape of your body \\n It's blue, the feeling I've got \\n And it's ooh, whoa oh \\n It's a cruel summer \\n It's cool, that's what I tell 'em \\n No rules in breakable heaven \\n But ooh, whoa oh \\n It's a cruel summer \\n With you \\n You got that James Dean daydream look in your eye \\n And I got that red lip classic thing that you like \\n And when we go crashing down, we come back every time \\n 'Cause we never go out of style, we never go out of style \\n You got that long hair, slicked back, white t-shirt \\n And I got that good girl faith and a tight little skirt \\n And when we go crashing down, we come back every time \\n 'Cause we never go out of style, we never go out of style \\n But if I just showed up at your party \\n Would you have me? Would you want me? \\n Would you tell me to go fuck myself \\n Or lead me to the garden? \\n In the garden, would you trust me \\n If I told you it was just a summer thing? \\n I'm only seventeen, I don't know anything \\n But I know I miss you \\n You're so gorgeous \\n I can't say anything to your face \\n 'Cause look at your face \\n And I'm so furious \\n At you for making me feel this way \\n But what can I say? \\n You're gorgeous \\n I’m so sick of running as fast as I can \\n Wondering if I'd get there quicker if I was a man \\n And I'm so sick of them coming at me again \\n 'Cause if I was a man, then I'd be the man \\n I'd be the man \\n I'd be the man \\n Don't blame me, love made me crazy \\n If it doesn't, you ain't doin' it right \\n Lord, save me, my drug is my baby \\n I'll be usin' for the rest of my life \\n They say I did something bad \\n Then why's it feel so good? \\n They say I did something bad \\n But why's it feel so good? \\n Most fun I ever had \\n And I'd do it over and over and over again if I could \\n It just felt so good, good \\n I didn't have it in myself to go with grace \\n And you're the hero flying around, saving face \\n And if I'm dead to you, why are you at the wake? \\n Cursing my name, wishing I stayed \\n Look at how my tears ricochet \\n Say my name and everything just stops \\n I don't want you like a best friend \\n Only bought this dress so you could take it off \\n Take it oh, ha, ha, ha-ah \\n Carve your name into my bedpost \\n ’Cause I don't want you like a best friend \\n Only bought this dress so you could take it off \\n Take it oh, ha, ha, ha-ah \\n And they said \\n There goes the last great American dynasty \\n Who knows, if she never showed up, what could've been \\n There goes the maddest woman this town has ever seen \\n She had a marvelous time ruining everything \\n I've been the archer, I've been the prey \\n Who could ever leave me, darling \\n But who could stay? \\n ’Cause baby, now we've got \""],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":8}],"source":["text[0:5000]"]},{"cell_type":"code","execution_count":9,"metadata":{"id":"eEsUIshbI86V","executionInfo":{"status":"ok","timestamp":1732288705716,"user_tz":360,"elapsed":995,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["S=[]\n","for l in data.lyric.tolist():\n","    if l[0]=='[':\n","        S.append(1)\n","    else:\n","        S.append(0)"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"MWChARcXI86W","outputId":"893df690-fc88-46f7-8f70-b6570235eb00","colab":{"base_uri":"https://localhost:8080/","height":458},"executionInfo":{"status":"ok","timestamp":1732288711255,"user_tz":360,"elapsed":374,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["       index                        album  \\\n","5          0                        Lover   \n","53         1                   reputation   \n","295        4                        Lover   \n","346        5                   reputation   \n","417        6                1989 (Deluxe)   \n","...      ...                          ...   \n","15865    455              Live from Paris   \n","16092    464  Teardrops On My Guitar - EP   \n","16133    466              Live from Paris   \n","16194    468              Live from Paris   \n","16248    469          Live from SoHo - EP   \n","\n","                                     song_title     lyric  line_number  \\\n","5                                        Lover   [Chorus]            5   \n","53                    Look What You Made Me Do   [Chorus]           14   \n","295                      You Need To Calm Down   [Chorus]           11   \n","346                           ...Ready for It?   [Chorus]           14   \n","417                                Blank Space   [Chorus]           18   \n","...                                         ...       ...          ...   \n","15865                  Lover (Live from Paris)   [Chorus]            5   \n","16092        Teardrops On My Guitar (Acoustic)   [Chorus]           16   \n","16133             The Archer (Live from Paris)   [Chorus]           10   \n","16194  You Need To Calm Down (Live from Paris)   [Chorus]           11   \n","16248         Picture to Burn (Live From SoHo)   [Chorus]            9   \n","\n","      release_date  \n","5       2019-08-16  \n","53      2017-08-25  \n","295     2019-06-14  \n","346     2017-09-03  \n","417     2014-10-27  \n","...            ...  \n","15865   2020-05-17  \n","16092   2007-02-19  \n","16133   2020-05-17  \n","16194   2020-05-17  \n","16248   2008-01-15  \n","\n","[220 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-9595711b-e095-420a-81e0-139b5f9a0d1e\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>index</th>\n","      <th>album</th>\n","      <th>song_title</th>\n","      <th>lyric</th>\n","      <th>line_number</th>\n","      <th>release_date</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>5</th>\n","      <td>0</td>\n","      <td>Lover</td>\n","      <td>Lover</td>\n","      <td>[Chorus]</td>\n","      <td>5</td>\n","      <td>2019-08-16</td>\n","    </tr>\n","    <tr>\n","      <th>53</th>\n","      <td>1</td>\n","      <td>reputation</td>\n","      <td>Look What You Made Me Do</td>\n","      <td>[Chorus]</td>\n","      <td>14</td>\n","      <td>2017-08-25</td>\n","    </tr>\n","    <tr>\n","      <th>295</th>\n","      <td>4</td>\n","      <td>Lover</td>\n","      <td>You Need To Calm Down</td>\n","      <td>[Chorus]</td>\n","      <td>11</td>\n","      <td>2019-06-14</td>\n","    </tr>\n","    <tr>\n","      <th>346</th>\n","      <td>5</td>\n","      <td>reputation</td>\n","      <td>...Ready for It?</td>\n","      <td>[Chorus]</td>\n","      <td>14</td>\n","      <td>2017-09-03</td>\n","    </tr>\n","    <tr>\n","      <th>417</th>\n","      <td>6</td>\n","      <td>1989 (Deluxe)</td>\n","      <td>Blank Space</td>\n","      <td>[Chorus]</td>\n","      <td>18</td>\n","      <td>2014-10-27</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>15865</th>\n","      <td>455</td>\n","      <td>Live from Paris</td>\n","      <td>Lover (Live from Paris)</td>\n","      <td>[Chorus]</td>\n","      <td>5</td>\n","      <td>2020-05-17</td>\n","    </tr>\n","    <tr>\n","      <th>16092</th>\n","      <td>464</td>\n","      <td>Teardrops On My Guitar - EP</td>\n","      <td>Teardrops On My Guitar (Acoustic)</td>\n","      <td>[Chorus]</td>\n","      <td>16</td>\n","      <td>2007-02-19</td>\n","    </tr>\n","    <tr>\n","      <th>16133</th>\n","      <td>466</td>\n","      <td>Live from Paris</td>\n","      <td>The Archer (Live from Paris)</td>\n","      <td>[Chorus]</td>\n","      <td>10</td>\n","      <td>2020-05-17</td>\n","    </tr>\n","    <tr>\n","      <th>16194</th>\n","      <td>468</td>\n","      <td>Live from Paris</td>\n","      <td>You Need To Calm Down (Live from Paris)</td>\n","      <td>[Chorus]</td>\n","      <td>11</td>\n","      <td>2020-05-17</td>\n","    </tr>\n","    <tr>\n","      <th>16248</th>\n","      <td>469</td>\n","      <td>Live from SoHo - EP</td>\n","      <td>Picture to Burn (Live From SoHo)</td>\n","      <td>[Chorus]</td>\n","      <td>9</td>\n","      <td>2008-01-15</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>220 rows × 6 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9595711b-e095-420a-81e0-139b5f9a0d1e')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-9595711b-e095-420a-81e0-139b5f9a0d1e button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-9595711b-e095-420a-81e0-139b5f9a0d1e');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-3cc150ba-1f70-41a8-b49b-5f8a5ac4f209\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-3cc150ba-1f70-41a8-b49b-5f8a5ac4f209')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-3cc150ba-1f70-41a8-b49b-5f8a5ac4f209 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","repr_error":"0"}},"metadata":{},"execution_count":10}],"source":["data[data.lyric=='[Chorus]'].drop_duplicates(subset='song_title')"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"X3I8J4UnI86W","outputId":"e30ec705-b922-4bd3-bc4d-aa5724c0c6a0","colab":{"base_uri":"https://localhost:8080/","height":209},"executionInfo":{"status":"ok","timestamp":1732288714471,"user_tz":360,"elapsed":387,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0                                            [Verse 1]\n","1    We could leave the Christmas lights up 'til Ja...\n","2             And this is our place, we make the rules\n","3    And there's a dazzling haze, a mysterious way ...\n","Name: lyric, dtype: object"],"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>lyric</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[Verse 1]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>We could leave the Christmas lights up 'til Ja...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>And this is our place, we make the rules</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>And there's a dazzling haze, a mysterious way ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div><br><label><b>dtype:</b> object</label>"]},"metadata":{},"execution_count":11}],"source":["data.lyric[0:4]"]},{"cell_type":"code","execution_count":12,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:42.950981Z","iopub.status.busy":"2020-10-14T01:46:42.950117Z","iopub.status.idle":"2020-10-14T01:46:42.952715Z","shell.execute_reply":"2020-10-14T01:46:42.953146Z"},"id":"IlCgQBRVymwR","outputId":"a786e48c-f4b4-4ea8-a107-905b1ca29949","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732288717294,"user_tz":360,"elapsed":604,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["73 unique characters\n"]}],"source":["# The unique characters in the file\n","vocab = sorted(set(text))\n","print('{} unique characters'.format(len(vocab)))\n","char2idx = {u:i for i, u in enumerate(vocab)}\n","idx2char = np.array(vocab)\n","\n","text_as_int = np.array([char2idx[c] for c in text])"]},{"cell_type":"code","execution_count":13,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:42.966713Z","iopub.status.busy":"2020-10-14T01:46:42.961317Z","iopub.status.idle":"2020-10-14T01:46:43.112934Z","shell.execute_reply":"2020-10-14T01:46:43.113337Z"},"id":"IalZLbvOzf-F","executionInfo":{"status":"ok","timestamp":1732288720721,"user_tz":360,"elapsed":1371,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["# Creating a mapping from unique characters to indices\n","char2idx = {u:i for i, u in enumerate(vocab)}\n","idx2char = np.array(vocab)\n","\n","text_as_int = np.array([char2idx[c] for c in text])\n","seq_length = 100\n","examples_per_epoch = len(text)//(seq_length+1)\n","\n","# Create training examples / targets\n","char_dataset = tf.data.Dataset.from_tensor_slices(text_as_int)\n","sequences = char_dataset.batch(seq_length+1, drop_remainder=True)\n"]},{"cell_type":"code","execution_count":14,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:44.494847Z","iopub.status.busy":"2020-10-14T01:46:44.494088Z","iopub.status.idle":"2020-10-14T01:46:44.509386Z","shell.execute_reply":"2020-10-14T01:46:44.508797Z"},"id":"0UHJDA39zf-O","executionInfo":{"status":"ok","timestamp":1732288725200,"user_tz":360,"elapsed":1034,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["# The maximum length sentence you want for a single input in characters\n","seq_length = 100\n","examples_per_epoch = len(text)//(seq_length+1)\n","\n","# Create training examples / targets\n","char_dataset = tf.data.Dataset.from_tensor_slices(text_as_int)\n","\n"]},{"cell_type":"code","execution_count":15,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:44.514806Z","iopub.status.busy":"2020-10-14T01:46:44.514150Z","iopub.status.idle":"2020-10-14T01:46:44.527695Z","shell.execute_reply":"2020-10-14T01:46:44.528111Z"},"id":"l4hkDU3i7ozi","executionInfo":{"status":"ok","timestamp":1732288727116,"user_tz":360,"elapsed":3,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["sequences = char_dataset.batch(seq_length+1, drop_remainder=True)\n","\n"]},{"cell_type":"code","execution_count":16,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:44.560283Z","iopub.status.busy":"2020-10-14T01:46:44.557720Z","iopub.status.idle":"2020-10-14T01:46:44.593416Z","shell.execute_reply":"2020-10-14T01:46:44.592859Z"},"id":"9NGu-FkO_kYU","executionInfo":{"status":"ok","timestamp":1732288730599,"user_tz":360,"elapsed":1416,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["def split_input_target(chunk):\n","    input_text = chunk[:-1]\n","    target_text = chunk[1:]\n","    return input_text, target_text\n","\n","dataset = sequences.map(split_input_target)"]},{"cell_type":"code","execution_count":17,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:44.921732Z","iopub.status.busy":"2020-10-14T01:46:44.921034Z","iopub.status.idle":"2020-10-14T01:46:44.932414Z","shell.execute_reply":"2020-10-14T01:46:44.932835Z"},"id":"p2pGotuNzf-S","outputId":"b4df996f-f4e3-40ef-9926-b53c3e7a01e6","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732288732950,"user_tz":360,"elapsed":384,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<_BatchDataset element_spec=(TensorSpec(shape=(10, 100), dtype=tf.int64, name=None), TensorSpec(shape=(10, 100), dtype=tf.int64, name=None))>"]},"metadata":{},"execution_count":17}],"source":["# Batch size\n","BATCH_SIZE = 10\n","\n","# Buffer size to shuffle the dataset\n","# (TF data is designed to work with possibly infinite sequences,\n","# so it doesn't attempt to shuffle the entire sequence in memory. Instead,\n","# it maintains a buffer in which it shuffles elements).\n","BUFFER_SIZE = 10000\n","\n","dataset = dataset.shuffle(BUFFER_SIZE).batch(BATCH_SIZE, drop_remainder=True)\n","\n","dataset"]},{"cell_type":"code","execution_count":18,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:44.937602Z","iopub.status.busy":"2020-10-14T01:46:44.936832Z","iopub.status.idle":"2020-10-14T01:46:44.939374Z","shell.execute_reply":"2020-10-14T01:46:44.938871Z"},"id":"zHT8cLh7EAsg","executionInfo":{"status":"ok","timestamp":1732288736359,"user_tz":360,"elapsed":980,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["# Length of the vocabulary in chars\n","vocab_size = len(vocab)\n","\n","# The embedding dimension\n","embedding_dim = 256\n","\n","# Number of RNN units\n","rnn_units = 1024"]},{"cell_type":"code","execution_count":19,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:44.944850Z","iopub.status.busy":"2020-10-14T01:46:44.944014Z","iopub.status.idle":"2020-10-14T01:46:44.946130Z","shell.execute_reply":"2020-10-14T01:46:44.946533Z"},"id":"MtCrdfzEI2N0","executionInfo":{"status":"ok","timestamp":1732288738953,"user_tz":360,"elapsed":889,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["def build_model(vocab_size, embedding_dim, rnn_units, batch_size):\n","    model = tf.keras.Sequential([\n","        tf.keras.layers.Input(shape=(None,), batch_size=batch_size, dtype=tf.int32),  # Explicit Input layer\n","        tf.keras.layers.Embedding(input_dim=vocab_size, output_dim=embedding_dim),\n","        tf.keras.layers.GRU(rnn_units,\n","                            return_sequences=True,\n","                            stateful=True,\n","                            recurrent_initializer='glorot_uniform',\n","                            reset_after=False ),\n","        tf.keras.layers.Dense(vocab_size)\n","    ])\n","    return model"]},{"cell_type":"code","execution_count":20,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:44.950589Z","iopub.status.busy":"2020-10-14T01:46:44.949936Z","iopub.status.idle":"2020-10-14T01:46:45.161891Z","shell.execute_reply":"2020-10-14T01:46:45.162336Z"},"id":"wwsrpOik5zhv","executionInfo":{"status":"ok","timestamp":1732288741716,"user_tz":360,"elapsed":381,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["model = build_model(\n","    vocab_size=len(vocab),\n","    embedding_dim=embedding_dim,\n","    rnn_units=rnn_units,\n","    batch_size=BATCH_SIZE)"]},{"cell_type":"code","execution_count":21,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:45.168118Z","iopub.status.busy":"2020-10-14T01:46:45.167395Z","iopub.status.idle":"2020-10-14T01:46:47.829144Z","shell.execute_reply":"2020-10-14T01:46:47.828625Z"},"id":"C-_70kKAPrPU","outputId":"28043942-fb20-4602-c45f-f289ec54037a","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732288747793,"user_tz":360,"elapsed":3480,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["(10, 100, 73) # (batch_size, sequence_length, vocab_size)\n"]}],"source":["for input_example_batch, target_example_batch in dataset.take(1):\n","    example_batch_predictions = model(input_example_batch)\n","    print(example_batch_predictions.shape, \"# (batch_size, sequence_length, vocab_size)\")"]},{"cell_type":"code","execution_count":22,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.835818Z","iopub.status.busy":"2020-10-14T01:46:47.834783Z","iopub.status.idle":"2020-10-14T01:46:47.838369Z","shell.execute_reply":"2020-10-14T01:46:47.837843Z"},"id":"vPGmAAXmVLGC","outputId":"bf79eb9a-abc1-4bc2-f60b-23502c5f1e92","colab":{"base_uri":"https://localhost:8080/","height":225},"executionInfo":{"status":"ok","timestamp":1732288750551,"user_tz":360,"elapsed":386,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"display_data","data":{"text/plain":["\u001b[1mModel: \"sequential\"\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"sequential\"</span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃\u001b[1m \u001b[0m\u001b[1mLayer (type)                        \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1mOutput Shape               \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1m        Param #\u001b[0m\u001b[1m \u001b[0m┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ embedding (\u001b[38;5;33mEmbedding\u001b[0m)                │ (\u001b[38;5;34m10\u001b[0m, \u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m256\u001b[0m)             │          \u001b[38;5;34m18,688\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ gru (\u001b[38;5;33mGRU\u001b[0m)                            │ (\u001b[38;5;34m10\u001b[0m, \u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1024\u001b[0m)            │       \u001b[38;5;34m3,935,232\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense (\u001b[38;5;33mDense\u001b[0m)                        │ (\u001b[38;5;34m10\u001b[0m, \u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m73\u001b[0m)              │          \u001b[38;5;34m74,825\u001b[0m │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃<span style=\"font-weight: bold\"> Layer (type)                         </span>┃<span style=\"font-weight: bold\"> Output Shape                </span>┃<span style=\"font-weight: bold\">         Param # </span>┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ embedding (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Embedding</span>)                │ (<span style=\"color: #00af00; text-decoration-color: #00af00\">10</span>, <span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">256</span>)             │          <span style=\"color: #00af00; text-decoration-color: #00af00\">18,688</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ gru (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">GRU</span>)                            │ (<span style=\"color: #00af00; text-decoration-color: #00af00\">10</span>, <span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1024</span>)            │       <span style=\"color: #00af00; text-decoration-color: #00af00\">3,935,232</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                        │ (<span style=\"color: #00af00; text-decoration-color: #00af00\">10</span>, <span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">73</span>)              │          <span style=\"color: #00af00; text-decoration-color: #00af00\">74,825</span> │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Total params: \u001b[0m\u001b[38;5;34m4,028,745\u001b[0m (15.37 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">4,028,745</span> (15.37 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Trainable params: \u001b[0m\u001b[38;5;34m4,028,745\u001b[0m (15.37 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">4,028,745</span> (15.37 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Non-trainable params: \u001b[0m\u001b[38;5;34m0\u001b[0m (0.00 B)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> (0.00 B)\n","</pre>\n"]},"metadata":{}}],"source":["model.summary()"]},{"cell_type":"code","execution_count":23,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.842856Z","iopub.status.busy":"2020-10-14T01:46:47.842025Z","iopub.status.idle":"2020-10-14T01:46:47.845423Z","shell.execute_reply":"2020-10-14T01:46:47.844929Z"},"id":"4V4MfFg0RQJg","executionInfo":{"status":"ok","timestamp":1732288754467,"user_tz":360,"elapsed":1001,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["sampled_indices = tf.random.categorical(example_batch_predictions[0], num_samples=1)\n","sampled_indices = tf.squeeze(sampled_indices,axis=-1).numpy()"]},{"cell_type":"code","execution_count":24,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.850314Z","iopub.status.busy":"2020-10-14T01:46:47.849486Z","iopub.status.idle":"2020-10-14T01:46:47.852877Z","shell.execute_reply":"2020-10-14T01:46:47.852389Z"},"id":"YqFMUQc_UFgM","outputId":"5972e278-1212-4610-824f-1bdfd8b8226d","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732288756664,"user_tz":360,"elapsed":375,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([10, 68, 70, 44, 11, 50, 60, 57, 41, 32, 55, 28, 56, 47,  0,  7, 68,\n","       52, 30, 53, 57, 26, 45, 18, 24, 26, 61, 27, 34, 50, 34, 51, 45, 28,\n","       48, 34, 62, 64, 60, 59, 15, 34, 51, 54, 33, 10, 62, 48,  3, 54,  4,\n","       64,  8, 17, 72,  6, 72, 25,  8, 60, 49, 10, 14, 19, 21, 33, 53, 70,\n","       34, 72, 38, 49, 16, 69, 71, 47, 12, 44, 61, 21, 51, 35, 56, 51, 57,\n","       15, 42, 45, 53,  4, 44, 63, 67, 44, 54, 36,  1, 71, 35, 61])"]},"metadata":{},"execution_count":24}],"source":["sampled_indices"]},{"cell_type":"code","execution_count":25,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.865987Z","iopub.status.busy":"2020-10-14T01:46:47.865306Z","iopub.status.idle":"2020-10-14T01:46:47.871046Z","shell.execute_reply":"2020-10-14T01:46:47.870604Z"},"id":"4HrXTACTdzY-","executionInfo":{"status":"ok","timestamp":1732288759202,"user_tz":360,"elapsed":389,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["def loss(labels, logits):\n","    return tf.keras.losses.sparse_categorical_crossentropy(labels, logits, from_logits=True)\n","\n","example_batch_loss = loss(target_example_batch, example_batch_predictions)\n"]},{"cell_type":"code","execution_count":26,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.883091Z","iopub.status.busy":"2020-10-14T01:46:47.882451Z","iopub.status.idle":"2020-10-14T01:46:47.890277Z","shell.execute_reply":"2020-10-14T01:46:47.889804Z"},"id":"DDl1_Een6rL0","executionInfo":{"status":"ok","timestamp":1732288761899,"user_tz":360,"elapsed":380,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["model.compile(optimizer='adam', loss=loss)"]},{"cell_type":"code","execution_count":27,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.895548Z","iopub.status.busy":"2020-10-14T01:46:47.894695Z","iopub.status.idle":"2020-10-14T01:46:47.896964Z","shell.execute_reply":"2020-10-14T01:46:47.897388Z"},"id":"W6fWTriUZP-n","executionInfo":{"status":"ok","timestamp":1732288764404,"user_tz":360,"elapsed":394,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["# Directory where the checkpoints will be saved\n","checkpoint_dir = './training_checkpoints'\n","# Name of the checkpoint files\n","checkpoint_prefix = os.path.join(checkpoint_dir, \"ckpt_{epoch}.weights.h5\")\n","\n","checkpoint_callback = tf.keras.callbacks.ModelCheckpoint(\n","    filepath=checkpoint_prefix,\n","    save_weights_only=True)"]},{"cell_type":"code","execution_count":28,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.901669Z","iopub.status.busy":"2020-10-14T01:46:47.900908Z","iopub.status.idle":"2020-10-14T01:46:47.903457Z","shell.execute_reply":"2020-10-14T01:46:47.902937Z"},"id":"7yGBE2zxMMHs","executionInfo":{"status":"ok","timestamp":1732288766532,"user_tz":360,"elapsed":2,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["EPOCHS = 50"]},{"cell_type":"code","execution_count":29,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:46:47.907722Z","iopub.status.busy":"2020-10-14T01:46:47.907092Z","iopub.status.idle":"2020-10-14T01:47:44.050116Z","shell.execute_reply":"2020-10-14T01:47:44.049522Z"},"id":"UK-hmKjYVoll","outputId":"76cda8fc-26fa-43f8-b5d8-a8ec088c7c5e","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732289011614,"user_tz":360,"elapsed":243472,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m9s\u001b[0m 110ms/step - loss: 4.1664\n","Epoch 2/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m7s\u001b[0m 108ms/step - loss: 2.4144\n","Epoch 3/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 110ms/step - loss: 2.1384\n","Epoch 4/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 109ms/step - loss: 1.9925\n","Epoch 5/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 107ms/step - loss: 1.8631\n","Epoch 6/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 110ms/step - loss: 1.7574\n","Epoch 7/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 108ms/step - loss: 1.6769\n","Epoch 8/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 107ms/step - loss: 1.5560\n","Epoch 9/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 113ms/step - loss: 1.4952\n","Epoch 10/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 108ms/step - loss: 1.3916\n","Epoch 11/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 110ms/step - loss: 1.2960\n","Epoch 12/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m6s\u001b[0m 119ms/step - loss: 1.1944\n","Epoch 13/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 108ms/step - loss: 1.0840\n","Epoch 14/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 113ms/step - loss: 0.9735\n","Epoch 15/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 114ms/step - loss: 0.8698\n","Epoch 16/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 108ms/step - loss: 0.7509\n","Epoch 17/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 115ms/step - loss: 0.6562\n","Epoch 18/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 109ms/step - loss: 0.5468\n","Epoch 19/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 110ms/step - loss: 0.4683\n","Epoch 20/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 113ms/step - loss: 0.3947\n","Epoch 21/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 109ms/step - loss: 0.3243\n","Epoch 22/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 112ms/step - loss: 0.2963\n","Epoch 23/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 109ms/step - loss: 0.2633\n","Epoch 24/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 109ms/step - loss: 0.2474\n","Epoch 25/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 113ms/step - loss: 0.2254\n","Epoch 26/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 108ms/step - loss: 0.2070\n","Epoch 27/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 108ms/step - loss: 0.1958\n","Epoch 28/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 114ms/step - loss: 0.1855\n","Epoch 29/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 109ms/step - loss: 0.1788\n","Epoch 30/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 110ms/step - loss: 0.1706\n","Epoch 31/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 110ms/step - loss: 0.1617\n","Epoch 32/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 109ms/step - loss: 0.1566\n","Epoch 33/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 114ms/step - loss: 0.1521\n","Epoch 34/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 108ms/step - loss: 0.1491\n","Epoch 35/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 109ms/step - loss: 0.1466\n","Epoch 36/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 113ms/step - loss: 0.1464\n","Epoch 37/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 108ms/step - loss: 0.1404\n","Epoch 38/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 110ms/step - loss: 0.1361\n","Epoch 39/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 113ms/step - loss: 0.1306\n","Epoch 40/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 109ms/step - loss: 0.1308\n","Epoch 41/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 112ms/step - loss: 0.1262\n","Epoch 42/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 111ms/step - loss: 0.1234\n","Epoch 43/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 109ms/step - loss: 0.1220\n","Epoch 44/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m4s\u001b[0m 113ms/step - loss: 0.1235\n","Epoch 45/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 108ms/step - loss: 0.1205\n","Epoch 46/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 109ms/step - loss: 0.1178\n","Epoch 47/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 112ms/step - loss: 0.1147\n","Epoch 48/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 108ms/step - loss: 0.1121\n","Epoch 49/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 114ms/step - loss: 0.1102\n","Epoch 50/50\n","\u001b[1m39/39\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m5s\u001b[0m 127ms/step - loss: 0.1152\n"]}],"source":["history = model.fit(dataset, epochs=EPOCHS, callbacks=[checkpoint_callback])"]},{"cell_type":"code","execution_count":30,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:47:44.055058Z","iopub.status.busy":"2020-10-14T01:47:44.054323Z","iopub.status.idle":"2020-10-14T01:47:44.059020Z","shell.execute_reply":"2020-10-14T01:47:44.058352Z"},"id":"zk2WJ2-XjkGz","executionInfo":{"status":"ok","timestamp":1732289073116,"user_tz":360,"elapsed":421,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["tf.train.latest_checkpoint(checkpoint_dir)"]},{"cell_type":"code","source":["import os\n","print(os.listdir(checkpoint_dir))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"i597XHdcqzHn","executionInfo":{"status":"ok","timestamp":1732289075136,"user_tz":360,"elapsed":3,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}},"outputId":"98abfa1d-b48a-4859-9a47-b9ebee1cb12c"},"execution_count":31,"outputs":[{"output_type":"stream","name":"stdout","text":["['ckpt_21.weights.h5', 'ckpt_46.weights.h5', 'ckpt_11.weights.h5', 'ckpt_44.weights.h5', 'ckpt_4.weights.h5', 'ckpt_34.weights.h5', 'ckpt_33.weights.h5', 'ckpt_26.weights.h5', 'ckpt_41.weights.h5', 'ckpt_8.weights.h5', 'ckpt_19.weights.h5', 'ckpt_23.weights.h5', 'ckpt_35.weights.h5', 'ckpt_49.weights.h5', 'ckpt_24.weights.h5', 'ckpt_1.weights.h5', 'ckpt_39.weights.h5', 'ckpt_31.weights.h5', 'ckpt_28.weights.h5', 'ckpt_25.weights.h5', 'ckpt_14.weights.h5', 'ckpt_48.weights.h5', 'ckpt_2.weights.h5', 'ckpt_38.weights.h5', 'ckpt_32.weights.h5', 'ckpt_16.weights.h5', 'ckpt_37.weights.h5', 'ckpt_10.weights.h5', 'ckpt_43.weights.h5', 'ckpt_5.weights.h5', 'ckpt_50.weights.h5', 'ckpt_13.weights.h5', 'ckpt_18.weights.h5', 'ckpt_7.weights.h5', 'ckpt_27.weights.h5', 'ckpt_45.weights.h5', 'ckpt_17.weights.h5', 'ckpt_3.weights.h5', 'ckpt_22.weights.h5', 'ckpt_40.weights.h5', 'ckpt_36.weights.h5', 'ckpt_15.weights.h5', 'ckpt_30.weights.h5', 'ckpt_9.weights.h5', 'ckpt_42.weights.h5', 'ckpt_6.weights.h5', 'ckpt_47.weights.h5', 'ckpt_20.weights.h5', 'ckpt_29.weights.h5', 'ckpt_12.weights.h5']\n"]}]},{"cell_type":"code","source":["latest_checkpoint = tf.train.latest_checkpoint(checkpoint_dir)\n","print(f\"Latest checkpoint: {latest_checkpoint}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mc-Uptfzrlgp","executionInfo":{"status":"ok","timestamp":1732289080221,"user_tz":360,"elapsed":1112,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}},"outputId":"4ca25630-de5f-4096-8f5f-6e474278c4ea"},"execution_count":32,"outputs":[{"output_type":"stream","name":"stdout","text":["Latest checkpoint: None\n"]}]},{"cell_type":"code","execution_count":33,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:47:44.069516Z","iopub.status.busy":"2020-10-14T01:47:44.068762Z","iopub.status.idle":"2020-10-14T01:47:44.282229Z","shell.execute_reply":"2020-10-14T01:47:44.281650Z"},"id":"LycQ-ot_jjyu","executionInfo":{"status":"ok","timestamp":1732289082788,"user_tz":360,"elapsed":981,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["model = build_model(vocab_size, embedding_dim, rnn_units, batch_size=1)\n","\n","latest_checkpoint = os.path.join(checkpoint_dir, \"ckpt_50.weights.h5\")\n","model.load_weights(latest_checkpoint)\n","\n","model.build(tf.TensorShape([1, None]))"]},{"cell_type":"code","source":["# Saving the model in TensorFlow format\n","model.save('taylor_swift.keras')"],"metadata":{"id":"igBFzkWUln_f","executionInfo":{"status":"ok","timestamp":1732289087306,"user_tz":360,"elapsed":1067,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"execution_count":34,"outputs":[]},{"cell_type":"code","execution_count":35,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:47:44.287368Z","iopub.status.busy":"2020-10-14T01:47:44.286735Z","iopub.status.idle":"2020-10-14T01:47:44.289856Z","shell.execute_reply":"2020-10-14T01:47:44.290263Z"},"id":"71xa6jnYVrAN","outputId":"7dc2861c-90c9-4120-c078-814dd02b7478","colab":{"base_uri":"https://localhost:8080/","height":225},"executionInfo":{"status":"ok","timestamp":1732289090144,"user_tz":360,"elapsed":793,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"display_data","data":{"text/plain":["\u001b[1mModel: \"sequential_1\"\u001b[0m\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"sequential_1\"</span>\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃\u001b[1m \u001b[0m\u001b[1mLayer (type)                        \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1mOutput Shape               \u001b[0m\u001b[1m \u001b[0m┃\u001b[1m \u001b[0m\u001b[1m        Param #\u001b[0m\u001b[1m \u001b[0m┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ embedding_1 (\u001b[38;5;33mEmbedding\u001b[0m)              │ (\u001b[38;5;34m1\u001b[0m, \u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m256\u001b[0m)              │          \u001b[38;5;34m18,688\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ gru_1 (\u001b[38;5;33mGRU\u001b[0m)                          │ (\u001b[38;5;34m1\u001b[0m, \u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1024\u001b[0m)             │       \u001b[38;5;34m3,935,232\u001b[0m │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_1 (\u001b[38;5;33mDense\u001b[0m)                      │ (\u001b[38;5;34m1\u001b[0m, \u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m73\u001b[0m)               │          \u001b[38;5;34m74,825\u001b[0m │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓\n","┃<span style=\"font-weight: bold\"> Layer (type)                         </span>┃<span style=\"font-weight: bold\"> Output Shape                </span>┃<span style=\"font-weight: bold\">         Param # </span>┃\n","┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩\n","│ embedding_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Embedding</span>)              │ (<span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>, <span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">256</span>)              │          <span style=\"color: #00af00; text-decoration-color: #00af00\">18,688</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ gru_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">GRU</span>)                          │ (<span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>, <span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1024</span>)             │       <span style=\"color: #00af00; text-decoration-color: #00af00\">3,935,232</span> │\n","├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤\n","│ dense_1 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)                      │ (<span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>, <span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">73</span>)               │          <span style=\"color: #00af00; text-decoration-color: #00af00\">74,825</span> │\n","└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Total params: \u001b[0m\u001b[38;5;34m4,028,745\u001b[0m (15.37 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">4,028,745</span> (15.37 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Trainable params: \u001b[0m\u001b[38;5;34m4,028,745\u001b[0m (15.37 MB)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">4,028,745</span> (15.37 MB)\n","</pre>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["\u001b[1m Non-trainable params: \u001b[0m\u001b[38;5;34m0\u001b[0m (0.00 B)\n"],"text/html":["<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">0</span> (0.00 B)\n","</pre>\n"]},"metadata":{}}],"source":["model.summary()"]},{"cell_type":"code","execution_count":36,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:47:44.297059Z","iopub.status.busy":"2020-10-14T01:47:44.296432Z","iopub.status.idle":"2020-10-14T01:47:44.298680Z","shell.execute_reply":"2020-10-14T01:47:44.298149Z"},"id":"WvuwZBX5Ogfd","executionInfo":{"status":"ok","timestamp":1732289093387,"user_tz":360,"elapsed":432,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[],"source":["def generate_text(model, start_string,t):\n","    # Evaluation step (generating text using the learned model)\n","\n","    # Number of characters to generate\n","    num_generate = 300\n","\n","    # Converting our start string to numbers (vectorizing)\n","    input_eval = [char2idx[s] for s in start_string]\n","    input_eval = tf.expand_dims(input_eval, 0)\n","\n","    # Empty string to store our results\n","    text_generated = []\n","\n","    # Low temperature results in more predictable text.\n","    # Higher temperature results in more surprising text.\n","    # Experiment to find the best setting.\n","    temperature = t\n","\n","    # Here batch size == 1\n","    #rnn_layer = model.layers[1]\n","    #model.reset_states()\n","    for layer in model.layers:\n","        if hasattr(layer, \"reset_states\"):\n","            layer.reset_states()\n","\n","    for i in range(num_generate):\n","        predictions = model(input_eval)\n","        # remove the batch dimension\n","        predictions = tf.squeeze(predictions, 0)\n","\n","        # using a categorical distribution to predict the character returned by the model\n","        predictions = predictions / temperature\n","        predicted_id = tf.random.categorical(predictions, num_samples=1)[-1,0].numpy()\n","\n","        # Pass the predicted character as the next input to the model\n","        # along with the previous hidden state\n","        input_eval = tf.expand_dims([predicted_id], 0)\n","\n","        text_generated.append(idx2char[predicted_id])\n","\n","    return (start_string + ''.join(text_generated))"]},{"cell_type":"code","execution_count":37,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:47:44.302653Z","iopub.status.busy":"2020-10-14T01:47:44.302037Z","iopub.status.idle":"2020-10-14T01:47:48.000324Z","shell.execute_reply":"2020-10-14T01:47:48.000767Z"},"id":"ktovv0RFhrkn","outputId":"95ee3c02-99a7-40b7-dc5d-821b612646fa","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732289104921,"user_tz":360,"elapsed":5999,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Call me that you're sorry \n"," But I don't believe you baby like I did before \n"," You're not sorry (No no no \n"," There's a whole a lot of good people in heaven \n"," And I don't wanna get there too soon \n"," And I ain't gotta tell him, I think he knows \n"," I think he knows \n"," Hey, it's all me, in my dreams \n"," You should see\n"]}],"source":["print(generate_text(model, start_string=u\"Call me\",t=0.3))"]},{"cell_type":"code","execution_count":44,"metadata":{"execution":{"iopub.execute_input":"2020-10-14T01:47:44.302653Z","iopub.status.busy":"2020-10-14T01:47:44.302037Z","iopub.status.idle":"2020-10-14T01:47:48.000324Z","shell.execute_reply":"2020-10-14T01:47:48.000767Z"},"id":"SX401D9rI86c","outputId":"60d2c037-d45d-4278-ca84-7879dc42ced8","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732260122042,"user_tz":360,"elapsed":3555,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["So me \n"," And I should've been there in the back of your mind \n"," I shouldn't be asking myself why \n"," You want to tell you \n"," It takes everything will be alright if you keep me next to you \n"," You don't know about me, but I'll bet you want to be with me too \n"," So I'ma stay through it all \n"," So jump then fall \n"," \n"]}],"source":["print(generate_text(model, start_string=u\"So\", t=0.2))"]},{"cell_type":"code","execution_count":45,"metadata":{"id":"3hDA4443I86d","outputId":"d7c234df-d637-4ae5-b077-cc3a72330055","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732260129969,"user_tz":360,"elapsed":2861,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Why when it's not \n"," It's death by a thousand cuts \n"," Flashbacks waking me up \n"," I get drunk, but it's not a bad girl, but I \n"," Oh me out \n"," Cross your heart, won't tell no other \n"," And that small the pag you can't feel nothing at all \n"," And you flashback to when he said forever and always \n"," Oh, an my dreams \n"]}],"source":["print(generate_text(model, start_string=u\"Why\", t=0.8))"]},{"cell_type":"code","execution_count":46,"metadata":{"id":"kJEXWFXBI86d","outputId":"db3fb560-dc94-43ca-ed0f-dc98db7c3274","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1732260139028,"user_tz":360,"elapsed":2809,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Let me down, oh \n"," I knew you were trouble when you walked in \n"," So, shame on me now \n"," Flew me to places I'd never been \n"," 'Til you punder my head \n"," They say I’ve always known \n"," What I wanted \n"," My friends and enemies \n"," Will tell you it in myself to go with grace \n"," And you're the hero flying around, saving fa\n"]}],"source":["print(generate_text(model, start_string=u\"Let me\", t=0.7))"]},{"cell_type":"markdown","source":[],"metadata":{"id":"ti6lrEOxeu65"}},{"cell_type":"code","source":["pip install tensorflowjs"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"aO7lUQZFejzS","executionInfo":{"status":"ok","timestamp":1732289252160,"user_tz":360,"elapsed":80075,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}},"outputId":"45fc5976-21a9-4ffd-c9ff-ed0cb9abe923"},"execution_count":38,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting tensorflowjs\n","  Downloading tensorflowjs-4.22.0-py3-none-any.whl.metadata (3.2 kB)\n","Requirement already satisfied: flax>=0.7.2 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (0.8.4)\n","Requirement already satisfied: importlib_resources>=5.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (6.4.5)\n","Requirement already satisfied: jax>=0.4.13 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (0.4.26)\n","Requirement already satisfied: jaxlib>=0.4.13 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (0.4.26+cuda12.cudnn89)\n","Requirement already satisfied: tensorflow<3,>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (2.17.0)\n","Requirement already satisfied: tf-keras>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (2.17.0)\n","Collecting tensorflow-decision-forests>=1.5.0 (from tensorflowjs)\n","  Downloading tensorflow_decision_forests-1.11.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.0 kB)\n","Requirement already satisfied: six<2,>=1.16.0 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (1.16.0)\n","Requirement already satisfied: tensorflow-hub>=0.16.1 in /usr/local/lib/python3.10/dist-packages (from tensorflowjs) (0.16.1)\n","Collecting packaging~=23.1 (from tensorflowjs)\n","  Downloading packaging-23.2-py3-none-any.whl.metadata (3.2 kB)\n","Requirement already satisfied: numpy>=1.22 in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (1.26.4)\n","Requirement already satisfied: msgpack in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (1.0.8)\n","Requirement already satisfied: optax in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (0.2.2)\n","Requirement already satisfied: orbax-checkpoint in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (0.6.4)\n","Requirement already satisfied: tensorstore in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (0.1.65)\n","Requirement already satisfied: rich>=11.1 in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (13.8.1)\n","Requirement already satisfied: typing-extensions>=4.2 in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (4.12.2)\n","Requirement already satisfied: PyYAML>=5.4.1 in /usr/local/lib/python3.10/dist-packages (from flax>=0.7.2->tensorflowjs) (6.0.2)\n","Requirement already satisfied: ml-dtypes>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from jax>=0.4.13->tensorflowjs) (0.4.1)\n","Requirement already satisfied: opt-einsum in /usr/local/lib/python3.10/dist-packages (from jax>=0.4.13->tensorflowjs) (3.3.0)\n","Requirement already satisfied: scipy>=1.9 in /usr/local/lib/python3.10/dist-packages (from jax>=0.4.13->tensorflowjs) (1.13.1)\n","Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (1.4.0)\n","Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (1.6.3)\n","Requirement already satisfied: flatbuffers>=24.3.25 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (24.3.25)\n","Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (0.6.0)\n","Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (0.2.0)\n","Requirement already satisfied: h5py>=3.10.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (3.11.0)\n","Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (18.1.1)\n","Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (3.20.3)\n","Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (2.32.3)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (71.0.4)\n","Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (2.4.0)\n","Requirement already satisfied: wrapt>=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (1.16.0)\n","Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (1.64.1)\n","Requirement already satisfied: tensorboard<2.18,>=2.17 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (2.17.0)\n","Requirement already satisfied: keras>=3.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (3.4.1)\n","Requirement already satisfied: tensorflow-io-gcs-filesystem>=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow<3,>=2.13.0->tensorflowjs) (0.37.1)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from tensorflow-decision-forests>=1.5.0->tensorflowjs) (2.1.4)\n","Collecting tensorflow<3,>=2.13.0 (from tensorflowjs)\n","  Downloading tensorflow-2.18.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.1 kB)\n","Requirement already satisfied: wheel in /usr/local/lib/python3.10/dist-packages (from tensorflow-decision-forests>=1.5.0->tensorflowjs) (0.44.0)\n","Collecting wurlitzer (from tensorflow-decision-forests>=1.5.0->tensorflowjs)\n","  Downloading wurlitzer-3.1.1-py3-none-any.whl.metadata (2.5 kB)\n","Collecting ydf (from tensorflow-decision-forests>=1.5.0->tensorflowjs)\n","  Downloading ydf-0.8.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.2 kB)\n","Collecting tensorboard<2.19,>=2.18 (from tensorflow<3,>=2.13.0->tensorflowjs)\n","  Downloading tensorboard-2.18.0-py3-none-any.whl.metadata (1.6 kB)\n","Collecting keras>=3.5.0 (from tensorflow<3,>=2.13.0->tensorflowjs)\n","  Downloading keras-3.6.0-py3-none-any.whl.metadata (5.8 kB)\n","INFO: pip is looking at multiple versions of tf-keras to determine which version is compatible with other requirements. This could take a while.\n","Collecting tf-keras>=2.13.0 (from tensorflowjs)\n","  Downloading tf_keras-2.18.0-py3-none-any.whl.metadata (1.6 kB)\n","Requirement already satisfied: namex in /usr/local/lib/python3.10/dist-packages (from keras>=3.5.0->tensorflow<3,>=2.13.0->tensorflowjs) (0.0.8)\n","Requirement already satisfied: optree in /usr/local/lib/python3.10/dist-packages (from keras>=3.5.0->tensorflow<3,>=2.13.0->tensorflowjs) (0.12.1)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow<3,>=2.13.0->tensorflowjs) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow<3,>=2.13.0->tensorflowjs) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow<3,>=2.13.0->tensorflowjs) (2.2.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.21.0->tensorflow<3,>=2.13.0->tensorflowjs) (2024.8.30)\n","Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.10/dist-packages (from rich>=11.1->flax>=0.7.2->tensorflowjs) (3.0.0)\n","Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.10/dist-packages (from rich>=11.1->flax>=0.7.2->tensorflowjs) (2.18.0)\n","Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.19,>=2.18->tensorflow<3,>=2.13.0->tensorflowjs) (3.7)\n","Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.19,>=2.18->tensorflow<3,>=2.13.0->tensorflowjs) (0.7.2)\n","Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard<2.19,>=2.18->tensorflow<3,>=2.13.0->tensorflowjs) (3.0.4)\n","Requirement already satisfied: chex>=0.1.86 in /usr/local/lib/python3.10/dist-packages (from optax->flax>=0.7.2->tensorflowjs) (0.1.86)\n","Requirement already satisfied: etils[epath,epy] in /usr/local/lib/python3.10/dist-packages (from orbax-checkpoint->flax>=0.7.2->tensorflowjs) (1.9.4)\n","Requirement already satisfied: nest_asyncio in /usr/local/lib/python3.10/dist-packages (from orbax-checkpoint->flax>=0.7.2->tensorflowjs) (1.6.0)\n","Requirement already satisfied: humanize in /usr/local/lib/python3.10/dist-packages (from orbax-checkpoint->flax>=0.7.2->tensorflowjs) (4.10.0)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->tensorflow-decision-forests>=1.5.0->tensorflowjs) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->tensorflow-decision-forests>=1.5.0->tensorflowjs) (2024.2)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->tensorflow-decision-forests>=1.5.0->tensorflowjs) (2024.1)\n","Requirement already satisfied: toolz>=0.9.0 in /usr/local/lib/python3.10/dist-packages (from chex>=0.1.86->optax->flax>=0.7.2->tensorflowjs) (0.12.1)\n","Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.10/dist-packages (from markdown-it-py>=2.2.0->rich>=11.1->flax>=0.7.2->tensorflowjs) (0.1.2)\n","Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=1.0.1->tensorboard<2.19,>=2.18->tensorflow<3,>=2.13.0->tensorflowjs) (2.1.5)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from etils[epath,epy]->orbax-checkpoint->flax>=0.7.2->tensorflowjs) (2024.6.1)\n","Requirement already satisfied: zipp in /usr/local/lib/python3.10/dist-packages (from etils[epath,epy]->orbax-checkpoint->flax>=0.7.2->tensorflowjs) (3.20.2)\n","Downloading tensorflowjs-4.22.0-py3-none-any.whl (89 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m89.1/89.1 kB\u001b[0m \u001b[31m7.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading packaging-23.2-py3-none-any.whl (53 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m53.0/53.0 kB\u001b[0m \u001b[31m3.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tensorflow_decision_forests-1.11.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (15.9 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m15.9/15.9 MB\u001b[0m \u001b[31m95.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tensorflow-2.18.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (615.3 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m615.3/615.3 MB\u001b[0m \u001b[31m3.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tf_keras-2.18.0-py3-none-any.whl (1.7 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m64.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading keras-3.6.0-py3-none-any.whl (1.2 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.2/1.2 MB\u001b[0m \u001b[31m55.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tensorboard-2.18.0-py3-none-any.whl (5.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.5/5.5 MB\u001b[0m \u001b[31m102.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading wurlitzer-3.1.1-py3-none-any.whl (8.6 kB)\n","Downloading ydf-0.8.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (9.3 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m9.3/9.3 MB\u001b[0m \u001b[31m101.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: ydf, wurlitzer, packaging, tensorboard, keras, tensorflow, tf-keras, tensorflow-decision-forests, tensorflowjs\n","  Attempting uninstall: packaging\n","    Found existing installation: packaging 24.1\n","    Uninstalling packaging-24.1:\n","      Successfully uninstalled packaging-24.1\n","  Attempting uninstall: tensorboard\n","    Found existing installation: tensorboard 2.17.0\n","    Uninstalling tensorboard-2.17.0:\n","      Successfully uninstalled tensorboard-2.17.0\n","  Attempting uninstall: keras\n","    Found existing installation: keras 3.4.1\n","    Uninstalling keras-3.4.1:\n","      Successfully uninstalled keras-3.4.1\n","  Attempting uninstall: tensorflow\n","    Found existing installation: tensorflow 2.17.0\n","    Uninstalling tensorflow-2.17.0:\n","      Successfully uninstalled tensorflow-2.17.0\n","  Attempting uninstall: tf-keras\n","    Found existing installation: tf_keras 2.17.0\n","    Uninstalling tf_keras-2.17.0:\n","      Successfully uninstalled tf_keras-2.17.0\n","Successfully installed keras-3.6.0 packaging-23.2 tensorboard-2.18.0 tensorflow-2.18.0 tensorflow-decision-forests-1.11.0 tensorflowjs-4.22.0 tf-keras-2.18.0 wurlitzer-3.1.1 ydf-0.8.0\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["keras","tensorflow"]},"id":"594648e0c2ea483098b485fe2f36a6d3"}},"metadata":{}}]},{"cell_type":"code","source":["import tensorflowjs as tfjs"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":166},"id":"lraZ8tQifSG4","executionInfo":{"status":"ok","timestamp":1732289328339,"user_tz":360,"elapsed":4972,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}},"outputId":"bd4389f3-6fa9-4d80-cc9d-e7bdc6406c02"},"execution_count":1,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","<p style=\"margin:0px;\">🌲 Try <a href=\"https://ydf.readthedocs.io/en/latest/\" target=\"_blank\">YDF</a>, the successor of\n","    <a href=\"https://www.tensorflow.org/decision_forests\" target=\"_blank\">TensorFlow\n","        Decision Forests</a> using the same algorithms but with more features and faster\n","    training!\n","</p>\n","<div style=\"display: flex; flex-wrap: wrap; margin:5px;max-width: 880px;\">\n","    <div style=\"flex: 1; border-radius: 10px; background-color: F0F0F0; padding: 5px;\">\n","        <p\n","            style=\"font-weight: bold; margin:0px;text-align: center;border-bottom: 1px solid #C0C0C0;margin-bottom: 4px;\">\n","            Old code</p>\n","        <pre style=\"overflow-wrap: anywhere; overflow: auto; margin:0px;font-size: 9pt;\">\n","import tensorflow_decision_forests as tfdf\n","\n","tf_ds = tfdf.keras.pd_dataframe_to_tf_dataset(ds, label=\"l\")\n","model = tfdf.keras.RandomForestModel(label=\"l\")\n","model.fit(tf_ds)\n","</pre>\n","    </div>\n","    <div style=\"width: 5px;\"></div>\n","    <div style=\"flex: 1; border-radius: 10px; background-color: F0F0F0; padding: 5px;\">\n","        <p\n","            style=\"font-weight: bold; margin:0px;text-align: center;border-bottom: 1px solid #C0C0C0;margin-bottom: 4px;\">\n","            New code</p>\n","        <pre style=\"overflow-wrap: anywhere; overflow: auto; margin:0px;font-size: 9pt;\">\n","import ydf\n","\n","model = ydf.RandomForestLearner(label=\"l\").train(ds)\n","</pre>\n","    </div>\n","</div>\n","<p style=\"margin:0px;font-size: 9pt;\">(Learn more in the <a\n","        href=\"https://ydf.readthedocs.io/en/latest/tutorial/migrating_to_ydf/\" target=\"_blank\">migration\n","        guide</a>)</p>\n"]},"metadata":{}}]},{"cell_type":"code","source":["model = tf.keras.models.load_model('taylor_swift.keras')"],"metadata":{"id":"gFYC7ELifcJC","executionInfo":{"status":"ok","timestamp":1732289393015,"user_tz":360,"elapsed":402,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["model.compile()"],"metadata":{"id":"ap9KEKrCfoQP","executionInfo":{"status":"ok","timestamp":1732289406265,"user_tz":360,"elapsed":870,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["tfjs.converters.save_keras_model(model, 'taylor_swift_js')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"W81Z_c4eftXV","executionInfo":{"status":"ok","timestamp":1732289422632,"user_tz":360,"elapsed":961,"user":{"displayName":"Valeria Rodriguez Ramirez","userId":"12304265170516232042"}},"outputId":"2c3c235b-4476-4bd4-c1f6-a9d057a193e9"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"]},{"output_type":"stream","name":"stdout","text":["failed to lookup keras version from the file,\n","    this is likely a weight only file\n"]}]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.3"}},"nbformat":4,"nbformat_minor":0}


74 unique characters
['\n', '\r', ' ', '!', '"', "'", '(', ')', ',', '-', '.', '0', '1', '2', '3', '6', '9', ':', '?', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '—', '‘', '’', '…']
char2idx {'\n': 0, '\r': 1, ' ': 2, '!': 3, '"': 4, "'": 5, '(': 6, ')': 7, ',': 8, '-': 9, '.': 10, '0': 11, '1': 12, '2': 13, '3': 14, '6': 15, '9': 16, ':': 17, '?': 18, 'A': 19, 'B': 20, 'C': 21, 'D': 22, 'E': 23, 'F': 24, 'G': 25, 'H': 26, 'I': 27, 'J': 28, 'K': 29, 'L': 30, 'M': 31, 'N': 32, 'O': 33, 'P': 34, 'R': 35, 'S': 36, 'T': 37, 'U': 38, 'V': 39, 'W': 40, 'X': 41, 'Y': 42, 'Z': 43, 'a': 44, 'b': 45, 'c': 46, 'd': 47, 'e': 48, 'f': 49, 'g': 50, 'h': 51, 'i': 52, 'j': 53, 'k': 54, 'l': 55, 'm': 56, 'n': 57, 'o': 58, 'p': 59, 'q': 60, 'r': 61, 's': 62, 't': 63, 'u': 64, 'v': 65, 'w': 66, 'x': 67, 'y': 68, 'z': 69, '—': 70, '‘': 71, '’': 72, '…': 73}
['\n' '\r' ' ' '!' '"' "'" '(' ')' ',' '-' '.' '0' '1' '2' '3' '6' '9' ':'
 '?' 'A' 'B' 'C' 'D' 'E' 'F' 'G' 'H' 'I' 'J' 'K' 'L' 'M' 'N' 'O' 'P' 'R'
 'S' 'T' 'U' 'V' 'W' 'X' 'Y' 'Z' 'a' 'b' 'c' 'd' 'e' 'f' 'g' 'h' 'i' 'j'
 'k' 'l' 'm' 'n' 'o' 'p' 'q' 'r' 's' 't' 'u' 'v' 'w' 'x' 'y' 'z' '—' '‘'
 '’' '…']